/* ===============================================
   Aurora Luo Docsify · 响应式/多端适配版
   - 玻璃拟态 + 阅读进度 + 回到顶部
   - 右上主题按钮固定（刘海安全区）
   - 桌面/平板/手机多断点优化
   - 顶部下拉菜单在移动端溢出修复
   =============================================== */

/* —— 安全区（iOS 刘海） —— */
:root {
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}

/* —— 主题变量（亮 / 暗） —— */
:root {
  --theme-color: #7c4dff;

  /* 基础尺寸（用 clamp 适配不同屏幕） */
  --base-font-size: clamp(15px, 0.95vw + 10px, 18px);
  --page-gap: clamp(12px, 2vw, 24px);

  /* 侧栏与内容宽度 */
  --sidebar-width: 280px;
  --content-max: 980px;

  /* 亮色主题 */
  --bg: #f5f7fb;
  --text: #1b2430;
  --muted: #6c7a89;
  --card: rgba(255, 255, 255, 0.65);
  --border: rgba(124, 77, 255, 0.18);
  --quote-bg: rgba(124, 77, 255, 0.08);
  --code-bg: rgba(16, 22, 30, 0.04);
  --link: #5b6cff;
  --link-hover: #3742fa;

  /* 顶部导航 / 下拉 */
  --nav-bg: rgba(255,255,255,0.55);
  --nav-text: #1b2430;
  --dropdown-bg: rgba(255,255,255,0.92);
  --dropdown-text: #1b2430;
  --dropdown-shadow: 0 10px 30px rgba(0,0,0,.10);
  --dropdown-hover-bg: rgba(124,77,255,0.12);

  /* 锚点偏移（导航高度+进度条） */
  --anchor-offset: 90px;
}

:root[data-theme="dark"] {
  --bg: #0b0e12;
  --text: #e6edf3;
  --muted: #9aa7b2;
  --card: rgba(13, 17, 23, 0.55);
  --border: rgba(94, 104, 121, 0.25);
  --quote-bg: rgba(124, 77, 255, 0.12);
  --code-bg: rgba(255, 255, 255, 0.03);
  --link: #8ea0ff;
  --link-hover: #b9c4ff;

  --nav-bg: rgba(12,16,22,0.52);
  --nav-text: #e6edf3;
  --dropdown-bg: rgba(13,17,23,0.92);
  --dropdown-text: #e6edf3;
  --dropdown-shadow: 0 10px 30px rgba(0,0,0,.45);
  --dropdown-hover-bg: rgba(255,255,255,0.06);
}

/* —— 全局背景与排版 —— */
html, body {
  background:
    radial-gradient(650px 400px at 15% -10%, rgba(124,77,255,.10), transparent 60%),
    radial-gradient(650px 400px at 110% -10%, rgba(0,212,255,.10), transparent 60%),
    linear-gradient(180deg, var(--bg), var(--bg));
  color: var(--text);
  font-size: var(--base-font-size);
  -webkit-tap-highlight-color: transparent;
}

/* —— 顶部导航（玻璃态 + 固定） —— */
.app-nav {
  position: sticky; top: 0; left: 0; right: 0;
  z-index: 10005;
  background: var(--nav-bg) !important;
  color: var(--nav-text) !important;
  border-bottom: 1px solid var(--border);
  backdrop-filter: saturate(160%) blur(12px);
  -webkit-backdrop-filter: saturate(160%) blur(12px);
  display: flex; align-items: center; gap: 10px; flex-wrap: nowrap;
  min-height: 52px; padding: calc(6px + var(--safe-top)) var(--page-gap) 6px var(--page-gap);
}
.app-nav a { color: var(--nav-text) !important; text-decoration: none; }

/* 顶部下拉（移动端尺寸/溢出修复） */
.app-nav .dropdown, .app-nav .menu, .app-nav ul li > ul {
  background: var(--dropdown-bg) !important;
  color: var(--dropdown-text) !important;
  border: 1px solid var(--border) !important;
  border-radius: 12px !important;
  box-shadow: var(--dropdown-shadow) !important;
  backdrop-filter: blur(14px);
  max-height: calc(100vh - var(--safe-top) - 90px);
  overflow: auto;
}
.app-nav .menu a:hover { background: var(--dropdown-hover-bg) !important; }

/* —— 右上角主题切换（固定 + 安全区） —— */
#aurora-theme-toggle {
  position: fixed;
  top: calc(12px + var(--safe-top));
  right: calc(18px + var(--safe-right));
  z-index: 10010;
}
#theme-switch-btn {
  width: 42px; height: 42px; border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--card); color: var(--text);
  display: grid; place-items: center;
  box-shadow: 0 8px 26px rgba(0,0,0,.12);
  cursor: pointer; transition: all .2s ease;
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  font-size: 18px; line-height: 1;
}
#theme-switch-btn:hover { border-color: var(--theme-color); transform: translateY(-1px); }

/* —— 侧栏（玻璃态 + 留白修复） —— */
.sidebar {
  width: var(--sidebar-width) !important;
  background: rgba(255,255,255,0); /* 背景统一由下面容器提供 */
  color: var(--text);
  z-index: 10004;
}
.sidebar, .sidebar .sidebar-nav, .sidebar .app-name, .sidebar .search,
.sidebar .links, .sidebar .app-sub-sidebar {
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  background: var(--card) !important;
  border-right: 1px solid var(--border);
}
.sidebar .search .input-wrap input {
  background: var(--card) !important;
  color: var(--text) !important;
  border: 1px solid var(--border) !important;
  border-radius: 10px;
}
.sidebar a { color: var(--text) !important; border-radius: 8px; }
.sidebar li > a:hover { background: rgba(124,77,255,0.08) !important; }

/* —— 内容区 —— */
.content { max-width: none; padding: 0 var(--page-gap); }
.markdown-section {
  line-height: 1.85;
  color: var(--text);
  max-width: min(100%, var(--content-max));
  margin: 0 auto;
  background: transparent;
}
.markdown-section h1, .markdown-section h2, .markdown-section h3 {
  margin-top: 2.1rem;
}
.markdown-section blockquote {
  border-left: 4px solid var(--theme-color);
  background: var(--quote-bg); padding: .6rem 1rem; border-radius: 10px;
}
.markdown-section pre {
  background: var(--code-bg) !important;
  border: 1px solid var(--border); border-radius: 12px; padding: 12px 14px;
}
.markdown-section code:not(pre code) {
  background: var(--code-bg);
  border: 1px solid var(--border);
  border-radius: 6px; padding: 0 6px;
}
.markdown-section a { color: var(--link); border-bottom: 1px dashed transparent; }
.markdown-section a:hover { color: var(--link-hover); border-bottom-color: var(--link-hover); }

/* —— 桌面布局：侧栏固定、消除左侧留白 —— */
@media (min-width: 1300px) {
  .content { left: var(--sidebar-width) !important; transition: left .25s ease; }
  .app-nav { left: var(--sidebar-width) !important; transition: left .25s ease; }
  body.close .content { left: var(--sidebar-width) !important; }
  body.close .app-nav { left: var(--sidebar-width) !important; }
}

/* —— 平板：减小侧栏宽度 —— */
@media (min-width: 992px) and (max-width: 1299px) {
  :root { --sidebar-width: 240px; }
  .content { left: var(--sidebar-width) !important; }
  .app-nav { left: var(--sidebar-width) !important; }
}

/* —— 小平板与手机：侧栏覆盖式，内容不左移 —— */
@media (max-width: 991.98px) {
  :root { --sidebar-width: 0px; }
  .content { left: 0 !important; }
  .app-nav { left: 0 !important; }
  .sidebar { will-change: transform; transition: transform .25s ease; }
  body.close .sidebar { transform: translateX(-100%); }  /* 关闭=隐藏 */
  body:not(.close) .sidebar { transform: translateX(0); } /* 打开=浮出 */
}

/* —— 手机：按钮与间距缩小，防遮挡 —— */
@media (max-width: 767.98px) {
  #theme-switch-btn { width: 38px; height: 38px; font-size: 16px; }
  #aurora-theme-toggle { right: calc(14px + var(--safe-right)); top: calc(10px + var(--safe-top)); }
}

/* —— 锚点滚动偏移（兼容中文标题） —— */
.markdown-section h1[id],
.markdown-section h2[id],
.markdown-section h3[id],
.markdown-section h4[id],
.markdown-section h5[id],
.markdown-section h6[id] { scroll-margin-top: var(--anchor-offset); }

/* —— 顶部阅读进度条 —— */
#reading-progress {
  position: fixed; top: 0; left: 0; height: 3px; width: 0%;
  z-index: 10010;
  background: linear-gradient(90deg, var(--theme-color), #00d4ff);
  box-shadow: 0 0 6px rgba(124,77,255,.5);
}

/* —— 回到顶部按钮（不遮挡，带安全区） —— */
#back-to-top {
  position: fixed;
  right: calc(18px + var(--safe-right));
  bottom: calc(20px + var(--safe-bottom));
  width: 42px; height: 42px; border-radius: 10px;
  background: var(--card); color: var(--text);
  border: 1px solid var(--border);
  box-shadow: 0 8px 26px rgba(0,0,0,.12);
  display: grid; place-items: center;
  font-size: 18px; line-height: 1;
  cursor: pointer;
  opacity: 0; visibility: hidden; transform: translateY(8px);
  transition: all .22s ease;
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  z-index: 10010;
}
#back-to-top.show { opacity: 1; visibility: visible; transform: translateY(0); }
#back-to-top:hover { border-color: var(--theme-color); }

/* —— 细节：滚动条（可选） —— */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-thumb { background: rgba(0,0,0,.15); border-radius: 8px; }
:root[data-theme="dark"] ::-webkit-scrollbar-thumb { background: rgba(255,255,255,.15); }
