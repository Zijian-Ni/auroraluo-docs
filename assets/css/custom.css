/* ===============================================
   Aurora Luo Docsify · 无顶部导航 + 可折叠左侧侧栏（最终版）
   - 顶部导航隐藏
   - 桌面固定侧栏 + 正文 margin-left
   - 小屏抽屉式侧栏 + 正文全宽
   - 保留原有美化与细节
   =============================================== */

/* —— 安全区与基础变量 —— */
:root {
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);

  --theme-color: #7c4dff;
  --sidebar-width: 280px;      /* 左侧栏固定宽度（可改 260/300） */
  --content-max: 980px;        /* 正文最大宽度 */
  --anchor-offset: 18px;       /* 锚点偏移（无顶栏） */

  /* 亮色主题 */
  --bg: #f5f7fb;
  --text: #1b2430;
  --muted: #6c7a89;
  --card: rgba(255,255,255,0.75);
  --border: rgba(124,77,255,0.18);
  --quote-bg: rgba(124,77,255,0.08);
  --code-bg: rgba(16,22,30,0.04);
  --link: #5b6cff;
  --link-hover: #3742fa;
}

/* 暗色主题覆盖 */
:root[data-theme="dark"] {
  --bg: #0b0e12;
  --text: #e6edf3;
  --muted: #9aa7b2;
  --card: rgba(13,17,23,0.55);
  --border: rgba(94,104,121,0.25);
  --quote-bg: rgba(124,77,255,0.12);
  --code-bg: rgba(255,255,255,0.03);
  --link: #8ea0ff;
  --link-hover: #b9c4ff;
}

/* —— 全局背景与排版 —— */
html, body {
  background:
    radial-gradient(650px 400px at 15% -10%, rgba(124,77,255,.10), transparent 60%),
    radial-gradient(650px 400px at 110% -10%, rgba(0,212,255,.10), transparent 60%),
    linear-gradient(180deg, var(--bg), var(--bg));
  color: var(--text);
  font-size: clamp(15px, 0.95vw + 10px, 18px);
  -webkit-tap-highlight-color: transparent;
  overflow-x: hidden;
}

/* —— 顶部导航隐藏 —— */
.app-nav,
.app-nav.no-badge {
  display: none !important;
  visibility: hidden !important;
  height: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* —— 侧栏（固定 + 玻璃态） —— */
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: var(--sidebar-width) !important; /* 强制确保宽度不被主题改小 */
  height: 100vh;
  background: var(--card);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  border-right: 1px solid var(--border);
  z-index: 1000;
  transition: transform .25s ease;
  overflow-y: auto;
}
.sidebar a {
  color: var(--text) !important;
  border-radius: 8px;
}
.sidebar li > a:hover {
  background: rgba(124,77,255,0.1) !important;
}
.sidebar .search .input-wrap input {
  background: var(--card) !important;
  color: var(--text) !important;
  border: 1px solid var(--border) !important;
  border-radius: 10px;
}

/* —— 正文区域 —— */
.content {
  margin-left: var(--sidebar-width) !important; /* ✅ 只用 margin-left，不用 left/transform */
  padding: 2rem 2rem 4rem;
  position: relative;
}
.markdown-section {
  max-width: min(100%, var(--content-max));
  margin: 0 auto;
  line-height: 1.85;
}
.markdown-section h1,
.markdown-section h2,
.markdown-section h3 {
  margin-top: 2rem;
}
.markdown-section blockquote {
  border-left: 4px solid var(--theme-color);
  background: var(--quote-bg);
  padding: .6rem 1rem;
  border-radius: 10px;
}
.markdown-section pre {
  background: var(--code-bg) !important;
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 10px 12px;
}
.markdown-section code:not(pre code) {
  background: var(--code-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0 6px;
}
.markdown-section a {
  color: var(--link);
  border-bottom: 1px dashed transparent;
}
.markdown-section a:hover {
  color: var(--link-hover);
  border-bottom-color: var(--link-hover);
}

/* —— 锚点滚动偏移（防标题被顶） —— */
.markdown-section h1[id],
.markdown-section h2[id],
.markdown-section h3[id],
.markdown-section h4[id],
.markdown-section h5[id],
.markdown-section h6[id] {
  scroll-margin-top: var(--anchor-offset);
}

/* —— 小屏：抽屉式侧栏 + 正文全宽 —— */
@media (max-width: 991.98px) {
  .content {
    margin-left: 0 !important;    /* ✅ 不留白，不遮挡正文 */
  }

  .sidebar {
    transform: translateX(-100%); /* 默认收起（移出屏幕） */
    will-change: transform;
  }
  body:not(.close) .sidebar {
    transform: translateX(0);     /* 展开抽屉 */
  }

  /* 左上角 ☰ 按钮（由 JS 注入 #menu-toggle 元素） */
  #menu-toggle {
    position: fixed;
    top: calc(12px + var(--safe-top));
    left: calc(14px + var(--safe-left));
    width: 42px;
    height: 42px;
    z-index: 1100;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--card);
    display: grid;
    place-items: center;
    font-size: 22px;
    line-height: 1;
    cursor: pointer;
    box-shadow: 0 8px 26px rgba(0,0,0,.12);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
}

/* —— 侧栏展开时禁用横向滚动（体验更稳） —— */
body:not(.close) { overflow-x: hidden; }

/* —— 右上角主题按钮（如需） —— */
#aurora-theme-toggle {
  position: fixed;
  top: calc(12px + var(--safe-top));
  right: calc(18px + var(--safe-right));
  z-index: 10010;
}
#theme-switch-btn {
  width: 42px; height: 42px; border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--card); color: var(--text);
  display: grid; place-items: center;
  box-shadow: 0 8px 26px rgba(0,0,0,.12);
  cursor: pointer; transition: all .2s ease;
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  font-size: 18px; line-height: 1;
}
#theme-switch-btn:hover { border-color: var(--theme-color); transform: translateY(-1px); }

/* —— 顶部阅读进度条 —— */
#reading-progress {
  position: fixed;
  top: 0; left: 0;
  height: 3px; width: 0%;
  z-index: 10010;
  background: linear-gradient(90deg, var(--theme-color), #00d4ff);
  box-shadow: 0 0 6px rgba(124,77,255,.5);
}

/* —— 回到顶部按钮 —— */
#back-to-top {
  position: fixed;
  right: calc(18px + var(--safe-right));
  bottom: calc(20px + var(--safe-bottom));
  width: 42px; height: 42px; border-radius: 10px;
  background: var(--card); color: var(--text);
  border: 1px solid var(--border);
  box-shadow: 0 8px 26px rgba(0,0,0,.12);
  display: grid; place-items: center;
  font-size: 18px; line-height: 1;
  cursor: pointer;
  opacity: 0; visibility: hidden; transform: translateY(8px);
  transition: all .22s ease;
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  z-index: 10010;
}
#back-to-top.show { opacity: 1; visibility: visible; transform: translateY(0); }
#back-to-top:hover { border-color: var(--theme-color); }

/* —— 滚动条 —— */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-thumb { background: rgba(0,0,0,.15); border-radius: 8px; }
:root[data-theme="dark"] ::-webkit-scrollbar-thumb { background: rgba(255,255,255,.15); }

/* ===== 兜底防御：别让其他主题把内容挤出“白框” ===== */
.content { left: 0 !important; transform: none !important; }



/* ====== 固定：正文不再跟随移动（禁用 left/transform 位移） ====== */
.content {
  margin-left: var(--sidebar-width) !important; /* 桌面给侧栏让位 */
  left: 0 !important;
  transform: none !important;
  transition: none !important; /* 防止被脚本动态设置 left/transform 后产生动画 */
  position: relative !important;
}

/* 兜底：有主题/脚本会改 content 的偏移，全部清掉 */
@media (min-width: 992px) {
  .content { margin-left: var(--sidebar-width) !important; }
}

/* ====== 侧栏永远固定在左侧，用 transform 控制显隐 ====== */
.sidebar {
  position: fixed !important;
  top: 0; left: 0;
  width: var(--sidebar-width) !important;
  height: 100vh !important;
  z-index: 1000;
  transition: transform .28s ease !important;
  will-change: transform;
  /* 桌面默认展开 */
  transform: translateX(0) !important;
}

/* ====== 小屏：正文占满宽度，侧栏抽屉式隐藏/显示 ====== */
@media (max-width: 991.98px) {
  .content {
    margin-left: 0 !important;   /* 正文不让位，避免被遮挡/留白框 */
  }
  /* 默认隐藏到屏幕外；打开 class 时滑入 */
  .sidebar {
    transform: translateX(-100%) !important;  /* 默认隐藏 */
  }
  body.sidebar-open .sidebar {
    transform: translateX(0) !important;      /* 展开 */
  }

  /* 左上角 ☰ 按钮（JS 注入 #menu-toggle） */
  #menu-toggle {
    position: fixed;
    top: calc(12px + var(--safe-top));
    left: calc(14px + var(--safe-left));
    width: 42px; height: 42px;
    z-index: 1101;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--card);
    display: grid; place-items: center;
    font-size: 22px; line-height: 1;
    cursor: pointer;
    box-shadow: 0 8px 26px rgba(0,0,0,.12);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  /* 展开时的遮罩（点击遮罩可收起） */
  #sidebar-mask {
    position: fixed; inset: 0; z-index: 1100;
    background: rgba(0,0,0,.35);
    display: none;
  }
  body.sidebar-open #sidebar-mask { display: block; }
}

/* ====== 顶部导航永远隐藏（保证你想要的“无顶栏”） ====== */
.app-nav, .app-nav.no-badge {
  display: none !important;
  visibility: hidden !important;
  height: 0 !important; margin: 0 !important; padding: 0 !important;
}

/* ====== 锚点偏移（无顶栏） ====== */
:root { --anchor-offset: 18px; }
.markdown-section h1[id],
.markdown-section h2[id],
.markdown-section h3[id],
.markdown-section h4[id],
.markdown-section h5[id],
.markdown-section h6[id] { scroll-margin-top: var(--anchor-offset); }

