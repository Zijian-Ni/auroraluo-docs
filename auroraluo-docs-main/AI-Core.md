# 🤖 AI-Core · 智能核心（AuroraAI）

本页介绍 AuroraAI 的 **对话编排、Persona/记忆、语义检索（RAG）**、安全与鲁棒性、以及多模态（Sora 预留）。所有增强点已融合在各模块说明中，而非单独成页。

---

## 1. 对话编排（Pipeline）
> 从用户输入到最终回复的大致流程：

```
Input → 解析意图 → 读取上下文（短期）→ 引用长期画像（长期）
     → （可选）知识检索（RAG）→ 策略融合与结构化规划
     → 生成回答（温度/风格/格式）→ 表达多样化后处理 → 安全检查 → Output
```

### 1.1 关键能力
- **自然对话模式**：直接 @ 机器人即可，无需指令；
- **多轮上下文（STM）**：自动跟进最近话题，减少“断片感”；
- **话题总结**：在主题切换/上下文过长时，自动或手动**总结**，将信息“压缩”为后续要点；
- **表达多样化**：引入**同义替换/句式转换**，减少“机械复读”；
- **温度（`AURORA_TEMP`）**：控制创造性与稳健性。

---

## 2. Persona 与长期记忆（LTM）
### 2.1 Persona（人格）
- 描述**身份 + 语气 + 输出结构**三要素：  
  > “你是温柔的学术助教，先列要点再展开，避免颜文字。”  
- 可在对话中随时修改，**即时生效**；也会逐步沉淀为偏好。

### 2.2 长期记忆（用户画像）
- **记录**：称呼偏好、兴趣主题、格式偏好、禁忌点；
- **修正**：通过自然语言提示修正（例：“不要再用表情包”）；
- **清除/导出**：支持导出个人相关记录与请求清除（与管理员策略一致）。

> 💡 设计原则：**最小化必要** + **可解释可控**。所有个性化都应可查看、可修改、可关闭。

---

## 3. 语义检索（RAG）
### 3.1 工作流
1. 将用户 Query 向量化（本地小模型或外部 Embedding API）；  
2. 在向量库中 Top-K 召回相关片段；  
3. 对相近/重复片段**去重合并**；  
4. 注入回答上下文，**显式引用**片段/来源；  
5. 生成“**答案 + 引用**”的合成输出。

### 3.2 参数与策略
- `AURORA_VECT_MAX_FEATURES`、`AURORA_VECT_NGRAMS`：用于简易特征化/分词；
- Top-K 与重排策略：在召回前 N 条基础上按得分/覆盖度二次筛选；
- **引用门槛**：低置信度不引用，避免误导。

### 3.3 最佳实践
- 文档**按主题拆分**，标题即主题名；
- 内容**短句化 + 小节化**，便于片段引用；
- 每次更新资料后，尽快完成增量构建。

---

## 4. 安全与鲁棒性（Safety & Robustness）
- **限流**：用户/群双层限流（如 15 rpm / 60 rpm），防止刷屏与成本风险；
- **内容安全**：不合规请求会被拒绝/弱化/改写；
- **熔断降级**：外部 API 异常时自动切换到**本地模板**或**简化答复**；
- **可观测**：建议记录调用量、失败率、平均延迟与常见主题。

---

## 5. 多模态与 Sora 预留
- 已在 AI 核心中预留“**文字→视频**”生成的接口位置；
- 当 **Sora Video API** 对你的账号可用时，可直接调用视频生成；
- 若未开通，系统会给出**友好提示**与教程链接，不阻塞其他功能。

---

## 6. 交互示例（复制即用）
```
@机器人 我们周末要办社团分享会，给一个 90 分钟流程方案，按时间轴列出来。
@机器人 先输出 5 条要点，再根据我的选择逐条展开。
@机器人 用温柔学术助教的语气，总结下刚才讨论的结论，并给行动项。
@机器人 结合知识库回答：红石比较器的常见用法（请给引用片段）。
@机器人 如果 Sora 视频可用，帮我生成 10 秒“柴犬冲浪”的横版分镜脚本。
```
